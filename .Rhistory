theme_light() +
scale_x_discrete(labels = c("Sí", "No")) +
xlab('Respuesta') + ylab('Cantidad') + ggtitle('3.15 Falta de locales para acceder a alimentos saludables')
plot_eei3_4 <- hvs %>%
filter(eei_16 %in% c(1, 2)) %>%
ggplot(aes(x = eei_16)) +
geom_bar(width = 0.5, fill = "#5c7cf3") +
theme_light() +
scale_x_discrete(labels = c("Sí", "No")) +
xlab('Respuesta') + ylab('Cantidad') + ggtitle('3.16 Locales de venta de comida rápida o chatarra')
plot_eei3 <- grid.arrange(plot_eei3_1, plot_eei3_2, plot_eei3_3, plot_eei3_4,
top = "Problemas de infraestructura",
ncol = 2)
ggsave(plot_eei3, file="../output/graphs/plot_eei3.png", width=10, height=8)
library(grid)
plot_eei3 <- grid.arrange(plot_eei3_1, plot_eei3_2, plot_eei3_3, plot_eei3_4,
top = textGrob("¿Cuáles de los siguientes problemas de infraestructura o equipamiento identifica usted en el barrio o sector donde se encuentra el establecimiento educacional?",gp=gpar(fontsize=20,font=3)),
ncol = 2)
ggsave(plot_eei3, file="../output/graphs/plot_eei3.png", width=10, height=8)
plot_eei3_3 <- hvs %>%
filter(eei_15 %in% c(1, 2)) %>%
ggplot(aes(x = eei_15)) +
geom_bar(width = 0.5, fill = "#f3c35c") +
theme_light() +
scale_x_discrete(labels = c("Sí", "No")) +
xlab('Respuesta') + ylab('Cantidad') + ggtitle('3.15 Falta de locales de alimentos saludables')
plot_eei3 <- grid.arrange(plot_eei3_1, plot_eei3_2, plot_eei3_3, plot_eei3_4,
top = textGrob("Problemas de infraestructura o equipamiento", gp=gpar(fontsize=20,font=3)),
ncol = 2)
ggsave(plot_eei3, file="../output/graphs/plot_eei3.png", width=10, height=8)
plot_eei3 <- grid.arrange(plot_eei3_1, plot_eei3_2, plot_eei3_3, plot_eei3_4,
ncol = 2)
ggsave(plot_eei3, file="../output/graphs/plot_eei3.png", width=10, height=8)
plot_ge <- sjPlot::plot_stackfrq(dplyr::select(hvs, starts_with("ge_")),
vjust=rep(c("bottom", "top", "bottom", "top"),4),
sort.frq = "last.desc",
expand.grid =TRUE,
geom.colors = 'Spectral',
show.total = FALSE
)+
theme_light() +
theme(legend.position="bottom")
ggsave(plot_ge, file="output/graphs/plot_ge.png")
plot_ge <- sjPlot::plot_stackfrq(dplyr::select(hvs, starts_with("ge_")),
vjust=rep(c("bottom", "top", "bottom", "top"),4),
sort.frq = "last.desc",
expand.grid =TRUE,
geom.colors = 'Spectral',
show.total = FALSE
)+
theme_light() +
theme(legend.position="bottom")
ggsave(plot_ge, file="../output/graphs/plot_ge.png")
# Imprimir el resultado
get_labels(hvs)
# Imprimir el resultado
get_label(hvs)
plot_eei3_1 <- hvs %>%
filter(eei_13 %in% c(1, 2)) %>%
ggplot(aes(x = eei_13)) +
geom_bar(width = 0.5, fill = "#70d968") +
theme_light() +
scale_x_discrete(labels = c("Sí", "No")) +
xlab('Respuesta') + ylab('Cantidad') + ggtitle('3.13 Falta de plazas o áreas verdes') +
ylim(0,200)
plot_eei3_2 <- hvs %>%
filter(eei_14 %in% c(1, 2)) %>%
ggplot(aes(x = eei_14)) +
geom_bar(width = 0.5, fill = "#d96868") +
theme_light() +
scale_x_discrete(labels = c("Sí", "No")) +
xlab('Respuesta') + ylab('Cantidad') + ggtitle('3.14 Falta de infraestructura deportiva') +
ylim(0,200)
plot_eei3_3 <- hvs %>%
filter(eei_15 %in% c(1, 2)) %>%
ggplot(aes(x = eei_15)) +
geom_bar(width = 0.5, fill = "#f3c35c") +
theme_light() +
scale_x_discrete(labels = c("Sí", "No")) +
xlab('Respuesta') + ylab('Cantidad') + ggtitle('3.15 Falta de locales de alimentos saludables') +
ylim(0,200)
plot_eei3_4 <- hvs %>%
filter(eei_16 %in% c(1, 2)) %>%
ggplot(aes(x = eei_16)) +
geom_bar(width = 0.5, fill = "#5c7cf3") +
theme_light() +
scale_x_discrete(labels = c("Sí", "No")) +
xlab('Respuesta') + ylab('Cantidad') + ggtitle('3.16 Locales de venta de comida rápida o chatarra') +
ylim(0,200)
plot_eei3 <- grid.arrange(plot_eei3_1, plot_eei3_2, plot_eei3_3, plot_eei3_4,
ncol = 2)
plot_eei3_1 <- hvs %>%
filter(eei_13 %in% c(1, 2)) %>%
ggplot(aes(x = eei_13)) +
geom_bar(width = 0.5, fill = "#70d968") +
theme_light() +
scale_x_discrete(labels = c("Sí", "No")) +
xlab('Respuesta') + ylab('Cantidad') + ggtitle('3.13 Falta de plazas o áreas verdes') +
ylim(0,150)
plot_eei3_2 <- hvs %>%
filter(eei_14 %in% c(1, 2)) %>%
ggplot(aes(x = eei_14)) +
geom_bar(width = 0.5, fill = "#d96868") +
theme_light() +
scale_x_discrete(labels = c("Sí", "No")) +
xlab('Respuesta') + ylab('Cantidad') + ggtitle('3.14 Falta de infraestructura deportiva') +
ylim(0,150)
plot_eei3_3 <- hvs %>%
filter(eei_15 %in% c(1, 2)) %>%
ggplot(aes(x = eei_15)) +
geom_bar(width = 0.5, fill = "#f3c35c") +
theme_light() +
scale_x_discrete(labels = c("Sí", "No")) +
xlab('Respuesta') + ylab('Cantidad') + ggtitle('3.15 Falta de locales de alimentos saludables') +
ylim(0,150)
plot_eei3_4 <- hvs %>%
filter(eei_16 %in% c(1, 2)) %>%
ggplot(aes(x = eei_16)) +
geom_bar(width = 0.5, fill = "#5c7cf3") +
theme_light() +
scale_x_discrete(labels = c("Sí", "No")) +
xlab('Respuesta') + ylab('Cantidad') + ggtitle('3.16 Locales de venta de comida rápida o chatarra') +
ylim(0,150)
plot_eei3 <- grid.arrange(plot_eei3_1, plot_eei3_2, plot_eei3_3, plot_eei3_4,
ncol = 2)
ggsave(plot_eei3, file="../output/graphs/plot_eei3.png", width=10, height=8)
plot_eei3_1 <- hvs %>%
filter(eei_13 %in% c(1, 2)) %>%
ggplot(aes(x = eei_13)) +
geom_bar(width = 0.5, fill = "#70d968") +
theme_light() +
scale_x_discrete(labels = c("Sí", "No")) +
xlab('Respuesta') + ylab('Cantidad') + ggtitle('3.13 Falta de plazas o áreas verdes') +
ylim(0,130)
plot_eei3_2 <- hvs %>%
filter(eei_14 %in% c(1, 2)) %>%
ggplot(aes(x = eei_14)) +
geom_bar(width = 0.5, fill = "#d96868") +
theme_light() +
scale_x_discrete(labels = c("Sí", "No")) +
xlab('Respuesta') + ylab('Cantidad') + ggtitle('3.14 Falta de infraestructura deportiva') +
ylim(0,130)
plot_eei3_3 <- hvs %>%
filter(eei_15 %in% c(1, 2)) %>%
ggplot(aes(x = eei_15)) +
geom_bar(width = 0.5, fill = "#f3c35c") +
theme_light() +
scale_x_discrete(labels = c("Sí", "No")) +
xlab('Respuesta') + ylab('Cantidad') + ggtitle('3.15 Falta de locales de alimentos saludables') +
ylim(0,130)
plot_eei3_4 <- hvs %>%
filter(eei_16 %in% c(1, 2)) %>%
ggplot(aes(x = eei_16)) +
geom_bar(width = 0.5, fill = "#5c7cf3") +
theme_light() +
scale_x_discrete(labels = c("Sí", "No")) +
xlab('Respuesta') + ylab('Cantidad') + ggtitle('3.16 Locales de venta de comida rápida o chatarra') +
ylim(0,130)
plot_eei3 <- grid.arrange(plot_eei3_1, plot_eei3_2, plot_eei3_3, plot_eei3_4,
ncol = 2)
ggsave(plot_eei3, file="../output/graphs/plot_eei3.png", width=10, height=8)
plot_eei1 <- ggplot(hvs, aes(x = eei_2_1)) +
geom_bar(width = 0.5, fill = "#70d968") +
theme_light() +
xlab('Respuesta') + ylab('Cantidad') + ggtitle('3.13 Falta de plazas o áreas verdes')
plot_eei1
plot_eei1 <- ggplot(hvs, aes(x = eei_2_1)) +
geom_bar(width = 0.5, fill = "#70d968") + scale_x_discrete(labels = c("Nada", "Casi nada", "Algo", "Mucho", "NA")) +
theme_light() +
xlab('Respuesta') + ylab('Cantidad')
plot_eei1
summary(hvs$eei_2_1)
plot_eei1 <- ggplot(hvs, aes(x = eei_2_1)) +
geom_bar(width = 0.5, fill = "#70d968") + scale_x_discrete(labels = c("Casi nada", "Algo", "Mucho", "NA")) +
theme_light() +
xlab('Respuesta') + ylab('Cantidad')
ggsave(plot_eei1, file="../output/graphs/plot_eei1.png", width=10, height=8)
plot_eei1 <- hvs %>%
filter(eei_13 %in% c(2, 3, 4)) %>%
ggplot(aes(x = eei_2_1)) +
geom_bar(width = 0.5, fill = "#70d968") + scale_x_discrete(labels = c("Casi nada", "Algo", "Mucho")) +
theme_light() +
xlab('Respuesta') + ylab('Cantidad')
ggsave(plot_eei1, file="../output/graphs/plot_eei1.png", width=10, height=8)
plot_eei1 <- hvs %>%
filter(eei_2_1 %in% c(2, 3, 4)) %>%
ggplot(aes(x = eei_2_1)) +
geom_bar(width = 0.5, fill = "#70d968") + scale_x_discrete(labels = c("Casi nada", "Algo", "Mucho")) +
theme_light() +
xlab('Respuesta') + ylab('Cantidad')
ggsave(plot_eei1, file="../output/graphs/plot_eei1.png", width=10, height=8)
plot_eei1 <- hvs %>%
filter(eei_2_1 %in% c(2, 3, 4)) %>%
ggplot(aes(x = eei_2_1)) +
geom_bar(width = 0.5, fill = "#70d968") + scale_x_discrete(labels = c("Casi nada", "Algo", "Mucho")) +
theme_light() +
xlab('Respuesta') + ylab('Cantidad') + scale_fill_brewer(palette = "Spectral")
plot_eei1
ggsave(plot_eei1, file="../output/graphs/plot_eei1.png", width=10, height=8)
plot_eei1 <- hvs %>%
filter(eei_2_1 %in% c(2, 3, 4)) %>%
ggplot(aes(x = eei_2_1)) +
geom_bar(width = 0.5, fill = "#70d968") + scale_x_discrete(labels = c("Casi nada", "Algo", "Mucho")) +
theme_light() +
xlab('Respuesta') + ylab('Cantidad') + scale_fill_manual(values = c("red", "green", "blue"))
plot_eei1
# No me convence
plot_eei1 <- hvs %>%
filter(eei_2_1 %in% c(2, 3, 4)) %>%
ggplot(aes(x = eei_2_1)) +
geom_bar(width = 0.5) + scale_x_discrete(labels = c("Casi nada", "Algo", "Mucho")) +
theme_light() +
xlab('Respuesta') + ylab('Cantidad') + scale_fill_manual(values = c("red", "green", "blue"))
plot_eei1
plot_eei1 <- hvs %>%
filter(eei_2_1 %in% c(2, 3, 4)) %>%
ggplot(aes(x = eei_2_1)) +
geom_bar(width = 0.5) + scale_x_discrete(labels = c("Casi nada", "Algo", "Mucho")) +
theme_light() + scale_fill_manual(values = c("purple", "orange", "darkblue")) +
xlab('Respuesta') + ylab('Cantidad')
plot_eei1
plot_eei1 <- hvs %>%
filter(eei_2_1 %in% c(2, 3, 4)) %>%
ggplot(aes(x = eei_2_1)) +
geom_bar(fill = '#d96868',width = 0.5) + scale_x_discrete(labels = c("Casi nada", "Algo", "Mucho")) +
theme_light() +
xlab('Respuesta') + ylab('Cantidad')
ggsave(plot_eei1, file="../output/graphs/plot_eei1.png", width=10, height=8)
knitr::opts_chunk$set(
echo = FALSE,
results = "asis",
message = FALSE,
warning = FALSE,
fig.height = 18,
fig.width = 11,
cache = TRUE
)
options(scipen=9999) # desactivar notacion cientifica
remove(list = ls()) #limpieza del entorno de trabajo
pacman::p_load(dplyr, ggplot2, sjmisc, sjlabelled, sjPlot, ggrepel)
library(Hmisc)
library(tidyverse)
library(memisc)
library(codebook)
library(ggeasy)
library(gridExtra)
library(grid)
load("../input/data/proc/hvs_proc.RData")
hvs$promedio1 <-  mean(hvs$porcentaje_1)
View(hvs)
mean(hvs$porcentaje_1)
View(hvs)
mean(hvs$porcentaje_1, na.rm = TRUE)
hvs$promedio1 <-  mean(hvs$porcentaje_1, na.rm = TRUE)
View(hvs)
hvs$promedio2 <-  mean(hvs$porcentaje_2, na.rm = TRUE)
mean(hvs$porcentaje_2, na.rm = TRUE)
hvs$promedio3 <-  mean(hvs$porcentaje_3, na.rm = TRUE)
hvs$promedio3 <-  mean(hvs$porcentaje_3, na.rm = TRUE)
mean(hvs$porcentaje_3, na.rm = TRUE)
hvs_long <- tidyr::gather(hvs, key = "variable", value = "porcentaje", promedio1, promedio2, promedio3)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Promedios de porcentajes", y = "Promedio") +
theme_light()
plot_porcentajes
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Estudiantes que se trasladan al establecimiento caminando o en bicicleta", "Estudiantes que practican deportes de manera extraprogramática en el establecimiento", "Estudiantes que practican deportes de manera extraprogramática fuera del establecimiento")) +
labs(y = "Porcentaje promedio") +
theme_light()
plot_porcentajes
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Estudiantes que se trasladan al establecimiento caminando o en bicicleta", "Estudiantes que practican deportes de manera extraprogramática en el establecimiento", "Estudiantes que practican deportes de manera extraprogramática fuera del establecimiento"), breaks = waiver()) +
labs(y = "Porcentaje promedio") +
theme_light()
ggsave(plot_hva_p, file="../output/graphs/plot_hva_p.png", width=10, height=8)
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Estudiantes que se trasladan al establecimiento caminando o en bicicleta", "Estudiantes que practican deportes de manera extraprogramática en el establecimiento", "Estudiantes que practican deportes de manera extraprogramática fuera del establecimiento")) +
labs(y = "Porcentaje promedio") +
theme_light() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Estudiantes que se trasladan al establecimiento caminando o en bicicleta", "Estudiantes que practican deportes de manera extraprogramática en el establecimiento", "Estudiantes que practican deportes de manera extraprogramática fuera del establecimiento")) +
labs(y = "Porcentaje promedio") +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5, size = 10))
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Estudiantes que se trasladan al establecimiento caminando o en bicicleta", "Estudiantes que practican deportes de manera extraprogramática en el establecimiento", "Estudiantes que practican deportes de manera extraprogramática fuera del establecimiento")) +
labs(y = "Porcentaje promedio") +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5, size = 10)) +
scale_fill_brewer(palette = "Spectral") +
theme(legend.position="none")
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c(expression("Estudiantes que se trasladan" * phantom(" ") * "al establecimiento caminando o en bicicleta"), "Estudiantes que practican deportes de manera extraprogramática en el establecimiento", "Estudiantes que practican deportes de manera extraprogramática fuera del establecimiento")) +
labs(y = "Porcentaje promedio") +
scale_fill_brewer(palette = "Spectral") +
theme(legend.position="none")
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Se trasladan al establecimiento caminando o en bicicleta", "practican deportes de manera extraprogramática en el establecimiento", "Practican deportes de manera extraprogramática fuera del establecimiento")) +
labs(x = 'Estudiantes', y = "Porcentaje promedio") +
scale_fill_brewer(palette = "Spectral") +
theme(legend.position="none")
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Se trasladan al establecimiento\ncaminando o en bicicleta", "Practican deportes de manera extraprogramática en el establecimiento", "Practican deportes de manera extraprogramática fuera del establecimiento")) +
labs(x = 'Estudiantes', y = "Porcentaje promedio") +
scale_fill_brewer(palette = "Spectral") +
theme(legend.position="none")
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Se trasladan al establecimiento\ncaminando o en bicicleta", "Practican deportes de\nmanera extraprogramática en\nel establecimiento", "Practican deportes de\nmanera extraprogramática\nfuera del establecimiento")) +
labs(x = 'Estudiantes', y = "Porcentaje promedio") +
scale_fill_brewer(palette = "Spectral") +
theme(legend.position="none")
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Se trasladan al establecimiento\ncaminando o en bicicleta", "Practican deportes de manera\nextraprogramática en\nel establecimiento", "Practican deportes de\nmanera extraprogramática\nfuera del establecimiento")) +
labs(x = 'Estudiantes', y = "Porcentaje promedio") +
scale_fill_brewer(palette = "Spectral") +
theme(legend.position="none")
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Se trasladan al establecimiento\ncaminando o en bicicleta", "Practican deportes de manera extraprogramática en el establecimiento", "Practican deportes de\nmanera extraprogramática\nfuera del establecimiento")) +
labs(x = 'Estudiantes', y = "Porcentaje promedio") +
scale_fill_brewer(palette = "Spectral") +
theme(legend.position="none")
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Se trasladan al establecimiento\ncaminando o en bicicleta", "Practican deportes de manera extraprogramática\nen el establecimiento", "Practican deportes de\nmanera extraprogramática\nfuera del establecimiento")) +
labs(x = 'Estudiantes', y = "Porcentaje promedio") +
scale_fill_brewer(palette = "Spectral") +
theme(legend.position="none")
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Se trasladan al establecimiento\ncaminando o en bicicleta", "Practican deportes de manera extraprogramática\nen el establecimiento", "Practican deportes de\nmanera extraprogramática\nfuera del establecimiento")) +
labs(x = 'Estudiantes', y = "Porcentaje promedio") +
geom_text(stat = 'identity') +
scale_fill_brewer(palette = "Spectral") +
theme(legend.position="none")
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Se trasladan al establecimiento\ncaminando o en bicicleta", "Practican deportes de manera extraprogramática\nen el establecimiento", "Practican deportes de\nmanera extraprogramática\nfuera del establecimiento")) +
labs(x = 'Estudiantes', y = "Porcentaje promedio") +
geom_text(aes(label = y), position = "dodge") +
scale_fill_brewer(palette = "Spectral") +
theme(legend.position="none")
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Se trasladan al establecimiento\ncaminando o en bicicleta", "Practican deportes de manera extraprogramática\nen el establecimiento", "Practican deportes de\nmanera extraprogramática\nfuera del establecimiento")) +
labs(x = 'Estudiantes', y = "Porcentaje promedio") +
geom_text(aes(label = porcentaje), position = "dodge") +
scale_fill_brewer(palette = "Spectral") +
theme(legend.position="none")
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
hvs$promedio1 <- round(hvs$promedio1, digits = 1)
round(hvs$promedio1, digits = 1)
hvs$promedio2 <- round(hvs$promedio2, digits = 1)
hvs$promedio3 <- round(hvs$promedio3, digits = 1)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Se trasladan al establecimiento\ncaminando o en bicicleta", "Practican deportes de manera extraprogramática\nen el establecimiento", "Practican deportes de\nmanera extraprogramática\nfuera del establecimiento")) +
labs(x = 'Estudiantes', y = "Porcentaje promedio") +
geom_text(aes(label = porcentaje), position = "dodge") +
scale_fill_brewer(palette = "Spectral") +
theme(legend.position="none")
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
hvs$promedio1 <- round(hvs$promedio1, digits = 1)
hvs$promedio2 <- round(hvs$promedio2, digits = 1)
hvs$promedio3 <- round(hvs$promedio3, digits = 1)
hvs_long <- tidyr::gather(hvs, key = "variable", value = "porcentaje", promedio1, promedio2, promedio3)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Se trasladan al establecimiento\ncaminando o en bicicleta", "Practican deportes de manera extraprogramática\nen el establecimiento", "Practican deportes de\nmanera extraprogramática\nfuera del establecimiento")) +
labs(x = 'Estudiantes', y = "Porcentaje promedio") +
geom_text(aes(label = porcentaje), position = "dodge") +
scale_fill_brewer(palette = "Spectral") +
theme(legend.position="none")
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
hvs$promedio1 <- paste0(hvs$promedio1, "%")
hvs$promedio1
hvs$promedio1 <- paste0(hvs$promedio1, "%")
hvs$promedio2 <- paste0(hvs$promedio2, "%")
hvs$promedio3 <- paste0(hvs$promedio3, "%")
hvs_long <- tidyr::gather(hvs, key = "variable", value = "porcentaje", promedio1, promedio2, promedio3)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Se trasladan al establecimiento\ncaminando o en bicicleta", "Practican deportes de manera extraprogramática\nen el establecimiento", "Practican deportes de\nmanera extraprogramática\nfuera del establecimiento")) +
labs(x = 'Estudiantes', y = "Porcentaje promedio") +
geom_text(aes(label = porcentaje), position = "dodge") +
scale_fill_brewer(palette = "Spectral") +
theme(legend.position="none")
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
load("../input/data/proc/hvs_proc.RData")
hvs$promedio1 <-  mean(hvs$porcentaje_1, na.rm = TRUE)
hvs$promedio2 <-  mean(hvs$porcentaje_2, na.rm = TRUE)
hvs$promedio3 <-  mean(hvs$porcentaje_3, na.rm = TRUE)
hvs$promedio1 <- round(hvs$promedio1, digits = 1)
hvs$promedio2 <- round(hvs$promedio2, digits = 1)
hvs$promedio3 <- round(hvs$promedio3, digits = 1)
hvs$promedio1_1 <- paste0(hvs$promedio1, "%")
hvs$promedio2_1 <- paste0(hvs$promedio2, "%")
hvs$promedio3_1 <- paste0(hvs$promedio3, "%")
hvs_long <- tidyr::gather(hvs, key = "variable", value = "porcentaje", promedio1, promedio2, promedio3)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Se trasladan al establecimiento\ncaminando o en bicicleta", "Practican deportes de manera extraprogramática\nen el establecimiento", "Practican deportes de\nmanera extraprogramática\nfuera del establecimiento")) +
labs(x = 'Estudiantes', y = "Porcentaje promedio") +
geom_text(aes(label = porcentaje), position = "dodge") +
scale_fill_brewer(palette = "Spectral") +
theme(legend.position="none")
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
hvs$promedio1 <-  mean(hvs$porcentaje_1, na.rm = TRUE)
hvs$promedio2 <-  mean(hvs$porcentaje_2, na.rm = TRUE)
hvs$promedio3 <-  mean(hvs$porcentaje_3, na.rm = TRUE)
hvs$promedio1 <- round(hvs$promedio1, digits = 1)
hvs$promedio2 <- round(hvs$promedio2, digits = 1)
hvs$promedio3 <- round(hvs$promedio3, digits = 1)
hvs_long <- tidyr::gather(hvs, key = "variable", value = "porcentaje", promedio1, promedio2, promedio3)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Se trasladan al establecimiento\ncaminando o en bicicleta", "Practican deportes de manera extraprogramática\nen el establecimiento", "Practican deportes de\nmanera extraprogramática\nfuera del establecimiento")) +
labs(x = 'Estudiantes', y = "Porcentaje promedio") +
geom_text(aes(label = paste0(porcentaje, "%")), position = "dodge") +
scale_fill_brewer(palette = "Spectral") +
theme(legend.position="none")
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
# Eliminar los asteriscos de las etiquetas
# Obtener nombres de las columnas con etiquetas
columnas_con_etiquetas <- names(hvs)
# Iterar sobre las columnas
for (col in columnas_con_etiquetas) {
# Verificar si la columna tiene etiquetas
if (has_label(hvs[[col]])) {
# Modificar las etiquetas eliminando los asteriscos
hvs[[col]] <- set_label(hvs[[col]], gsub("\\*", "", label(hvs[[col]])))
}
}
# Imprimir el resultado
get_label(hvs)
plot_hva <- sjPlot::plot_stackfrq(dplyr::select(hvs, starts_with("hva_")),
expand.grid =TRUE,
geom.colors = 'Spectre',
show.total = FALSE,
vjust=rep(c("bottom", "top", "bottom", "top"),7),
sort.frq = "last.desc"
) +
theme_light() +
theme(legend.position="bottom")
plot_hva
ggsave(plot_hva, file="../output/graphs/plot_hva.png", width=10, height=8)
plot_hva <- sjPlot::plot_stackfrq(dplyr::select(hvs, starts_with("hva_")),
expand.grid =TRUE,
geom.colors = 'Spectral',
show.total = FALSE,
vjust=rep(c("bottom", "top", "bottom", "top"),7),
sort.frq = "last.desc"
) +
theme_light() +
theme(legend.position="bottom")
plot_hva
ggsave(plot_hva, file="../output/graphs/plot_hva.png", width=10, height=8)
ggsave(plot_hva, file="../output/graphs/plot_hva.png", width=10, height=8)
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Se trasladan al establecimiento\ncaminando o en bicicleta", "Practican deportes de manera extraprogramática\nen el establecimiento", "Practican deportes de\nmanera extraprogramática\nfuera del establecimiento")) +
labs(x = 'Estudiantes', y = "Porcentaje promedio") +
geom_text(aes(label = paste0(porcentaje, "%")), position = "dodge") +
scale_fill_brewer(palette = "Spectral") +
theme(legend.position="none") +
theme_light()
plot_porcentajes
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
plot_porcentajes
plot_porcentajes <- ggplot(hvs_long, aes(x = variable, y = porcentaje, fill = variable)) +
geom_bar(stat = "identity", position = "dodge") +
scale_x_discrete(labels = c("Se trasladan al establecimiento\ncaminando o en bicicleta", "Practican deportes de manera extraprogramática\nen el establecimiento", "Practican deportes de\nmanera extraprogramática\nfuera del establecimiento")) +
labs(x = 'Estudiantes', y = "Porcentaje promedio") +
geom_text(aes(label = paste0(porcentaje, "%")), position = "dodge") +
scale_fill_brewer(palette = "Spectral") +
theme_light() +
theme(legend.position="none")
ggsave(plot_porcentajes, file="../output/graphs/plot_hva_p.png", width=10, height=8)
knitr::opts_chunk$set(
echo = FALSE,
results = "asis",
message = FALSE,
warning = FALSE,
fig.height = 18,
fig.width = 11,
cache = TRUE
)
options(scipen=9999) # desactivar notacion cientifica
remove(list = ls()) #limpieza del entorno de trabajo
